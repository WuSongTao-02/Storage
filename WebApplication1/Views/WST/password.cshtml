
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>password</title>
    <link href="~/X-admin/css/font.css" rel="stylesheet" />
    <link href="~/X-admin/css/xadmin.css" rel="stylesheet" />
</head>
<body>
    <div class="layui-fluid">
        <div class="layui-row">
            <form class="layui-form">
                <div class="layui-form-item">
                    <label for="L_username" class="layui-form-label">昵称</label>
                    <div class="layui-input-inline">
                        <input type="text" id="L_username" name="username" disabled="" value="" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label for="L_repass" class="layui-form-label">
                        <span class="x-red">*</span>旧密码
                    </label>
                    <div class="layui-input-inline">
                        <input type="password" id="L_repass"  required="" lay-verify="required" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label for="L_pass" class="layui-form-label">
                        <span class="x-red">*</span>新密码
                    </label>
                    <div class="layui-input-inline">
                        <input type="password" id="L_pass" required="" lay-verify="required" autocomplete="off" class="layui-input">
                    </div>
                    <div class="layui-form-mid layui-word-aux"></div>
                </div>
                <div class="layui-form-item">
                    <label for="L_repass" class="layui-form-label">
                        <span class="x-red">*</span>确认密码
                    </label>
                    <div class="layui-input-inline">
                        <input type="password" id="L_repass" required="" lay-verify="required" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label for="L_repass" class="layui-form-label"></label>
                    <button class="layui-btn" lay-filter="save" lay-submit="" id="btn">修改</button>
                </div>
            </form>
        </div>
    </div>

</body>
</html>
<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<script src="~/X-admin/lib/layui/layui.js" charset="utf-8"></script>
<script src="~/X-admin/js/xadmin.js"></script>
<script src="~/layer/layer.js"></script>
<script>
    var name = "@Request.QueryString["name"]";
    
    $(function () {
        $("#L_username").val(name);
      
    })
    $("#btn").click(function () {
        var oldPwd = $("#L_repass").val();
        var Pwd = $("#L_pass").val();
        var Pwds = $("#L_repass").val();

        
        $.ajax({
            type: "POST",//提交方式
            url: "/WST/Users",//请求的URL路径
            data: "{UserName:'" + name + "'}",//向服务器传递的参数
            dataType: "json",//预期服务器返回的数据类型
            contentType: "application/json",//发送信息至服务器时内容编码类型
            //请求成功后的回调函数
            success: function (result) {
               
                if (oldPwd == result[0].PassWord) {
                    if (Pwd == Pwds) {

                    } else {
                        layer.msg('两次密码不一样，请重新输入');
                        return;
                    }
                } else {
                   
                }
            },
            error: function (ex) {
                alert("Error:" + ex.responseText);
            }
        });
    })
</script>
